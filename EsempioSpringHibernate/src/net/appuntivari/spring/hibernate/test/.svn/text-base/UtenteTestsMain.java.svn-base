package it.tcweb.mains;

import java.util.ArrayList;
import java.util.List;

import it.tcweb.model.dao.IDAOService;
import it.tcweb.model.dto.Corso;
import it.tcweb.model.dto.EdizioneCorsuale;
import it.tcweb.model.dto.Sede;

import org.hibernate.Query;
import org.springframework.context.support.AbstractApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

public class UtenteTestsMain {

	public static void main(String[] args) {
		
		
		/* Carico il contesto di Spring */
		AbstractApplicationContext ctx = new ClassPathXmlApplicationContext(
				new String[]{
				"it/tcweb/config/spring/dao/spring_hibernate_config.xml"				
		});
		
		/* TEST INSERIMENTO DI UN CORSO */
		//Creo un Corso
		Corso corso = new Corso();
		corso.setArea("Area Hibernate Template");
		corso.setDescrizione("Corso Hibernate Template");
		corso.setTitolo("Hibernate Template");
				
		//Creo una EdizioneCorsuale
		EdizioneCorsuale edizioneCorsuale1 = new EdizioneCorsuale();
		edizioneCorsuale1.setNumeroMassimoAllievi(10);
		edizioneCorsuale1.setCorso(corso);
				
		//Creo una sede
		Sede sede1 = new Sede();
		sede1.setIndirizzo("Nuova via");
		sede1.setDescrizione("Sede principale nuova");
				
		//Associo la nuova sede alla edizione corsuale
		edizioneCorsuale1.setSede(sede1);
		
		//Creo una seconda sede
		Sede sede2 = new Sede();
		sede2.setIndirizzo("Nuova via");
		sede2.setDescrizione("Sede principale nuova");
		
		//Creo una seconda EdizioneCorsuale
		EdizioneCorsuale edizioneCorsuale2 = new EdizioneCorsuale();
		edizioneCorsuale2.setNumeroMassimoAllievi(20);
		edizioneCorsuale2.setCorso(corso);
		edizioneCorsuale2.setSede(sede2);
		
	
					
		//Carico le due edizioni corsuali su un ArrayList di EdizioniCorsuali 
		//e assegno l'ArrayList al corso 
		List<EdizioneCorsuale> edizioniCorsuali = new ArrayList<EdizioneCorsuale>();
		edizioniCorsuali.add(edizioneCorsuale1);
		edizioniCorsuali.add(edizioneCorsuale2);
		corso.setEdizioniCorsuali(edizioniCorsuali);
			
		
		IDAOService iDAOService = (IDAOService) ctx.getBean("dbService");
		iDAOService.createCorso(corso);
		
		/* N.B. Hibernate Template gestisce le transazioni "nativamente" */
		
	}
}
